{% extends 'Contributor/base.html' %}

{% block title %}Complete Profile{% endblock %}

{% block body %}
    {% include 'Contributor/header.html' %}
    {% include 'Contributor/sidebar.html' %}

    <main id="main" class="main">

        <div class="pagetitle">
        <h1>Create Profile</h1>
        <nav>
        <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'Contributor:dashboard' %}">Home</a></li>
        <li class="breadcrumb-item active">Create Profile</li>
        </ol>
        </nav>
        </div><!-- End Page Title -->

        <section class="section">
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Create Profile</h5>
                            <form method="post">
                                {% csrf_token %}
                                <div class="row mb-3">
                                  <label for="username" class="col-sm-2 col-form-label">Username</label>
                                  <div class="col-sm-10">
                                    <input name="username" id="username" type="text" class="form-control" value="{{ user.username }}" disabled>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="first_name" class="col-sm-2 col-form-label">First Name</label>
                                  <div class="col-sm-10">
                                    <input name="first_name" id="first_name" type="text" class="form-control" required pattern="[a-zA-Z]{2,}">
                                      <span style="color:red;" id="firstNameError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="last_name" class="col-sm-2 col-form-label">Last Name</label>
                                  <div class="col-sm-10">
                                    <input name="last_name" id="last_name" type="text" class="form-control" required pattern="[a-zA-Z]{2,}">
                                      <span style="color:red;" id="lastNameError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="email" class="col-sm-2 col-form-label">Email</label>
                                  <div class="col-sm-10">
                                    <input name="email" id="email" type="email" class="form-control" value="{{user.email}}" disabled >
                                      <span style="color:red;" id="emailError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="dob" class="col-sm-2 col-form-label">DOB</label>
                                  <div class="col-sm-10">
                                    <input name="dob" id="dob" type="date" max="2005-04-23" class="form-control" required>
                                      <span style="color:red;" id="dobError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="phone_number" class="col-sm-2 col-form-label">Phone Number</label>
                                  <div class="col-sm-10">
                                    <input name="phone_number" id="phone_number" type="text" class="form-control" pattern="^[+]?[0-9]{6,15}$" required>
                                    <span style="color:red;" id="phoneError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="city" class="col-sm-2 col-form-label">City</label>
                                  <div class="col-sm-10">
                                    <input name="city" id="city" type="text" class="form-control" pattern="[A-Za-z ]{1,50}" required>
                                    <span style="color:red;" id="cityError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label class="col-sm-2 col-form-label">College</label>
                                  <div class="col-sm-10">
                                    <select name="college" class="form-select" aria-label="Default select example" required>
                                      <option selected>Open this select menu</option>
                                      <option value="College 1">College 1</option>
                                      <option value="College 2">College 2</option>
                                      <option value="College 3">College 3</option>
                                    </select>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label class="col-sm-2 col-form-label">University</label>
                                  <div class="col-sm-10">
                                    <select name="university" class="form-select" aria-label="Default select example" required>
                                      <option selected>Open this select menu</option>
                                      <option value="University 1">University 1</option>
                                      <option value="University 2">University 2</option>
                                      <option value="University 3">University 3</option>
                                    </select>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="qualification" class="col-sm-2 col-form-label">Qualification</label>
                                  <div class="col-sm-10">
                                    <input name="qualification" id="qualification" type="text" class="form-control" pattern="[A-Za-z0-9 ]{1,50}" required>
                                    <span style="color:red;" id="qualificationError"></span><br><br>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="year_of_exp" class="col-sm-2 col-form-label">Years of Experience</label>
                                  <div class="col-sm-10">
                                    <input name="years_of_exp" id="year_of_exp" type="number" class="form-control" min="0" max="50" step="1" required>
                                    <span style="color:red;" id="experienceError"></span><br><br>
                                  </div>
                                </div>

                                {% if subjects %}

                                <div class="row mb-3">
                                  <label class="col-sm-2 col-form-label">Subjects to Contribute</label>
                                  <div class="col-sm-10">

                                    <select name="subjects_to_contrib" class="form-select" multiple aria-label="multiple select example" required>
                                        {% for subject in subjects %}
                                            <option value="{{subject}}">{{subject}}</option>
                                        {% endfor %}
                                    </select>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label class="col-sm-2 col-form-label">Subjects of Interest</label>
                                  <div class="col-sm-10">
                                    <select name="subjects_of_interest" class="form-select" multiple aria-label="multiple select example" required>
                                        {% for subject in subjects %}
                                            <option value="{{subject}}">{{subject}}</option>
                                        {% endfor %}
                                    </select>
                                  </div>
                                </div>

                                {% endif %}

                                <div class="row mb-3">
                                  <label for="linked_in" class="col-sm-2 col-form-label">Linked Profile</label>
                                  <div class="col-sm-10">
                                    <input name="linkedin" id="linked_in" type="text" class="form-control" required>
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="github" class="col-sm-2 col-form-label">Github Profile</label>
                                  <div class="col-sm-10">
                                    <input name="github" id="github" type="text" class="form-control">
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <label for="portfolio" class="col-sm-2 col-form-label">Portfolio Website</label>
                                  <div class="col-sm-10">
                                    <input name="portfolio" id="portfolio" type="text" class="form-control">
                                  </div>
                                </div>
                                <div class="row mb-3">
                                  <div class="col-sm-10">
                                    <button type="submit" class="btn btn-primary">Submit Form</button>
                                  </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main><!-- End #main -->

    {% include 'Contributor/footer.html' %}
    <script>
        window.onbeforeunload = function() {
            var text = "confirm leaving contributions page!";
            return text;
        }

        var firstNameInput = document.getElementById("first_name");
          firstNameInput.addEventListener("input", function() {
            if (firstNameInput.validity.patternMismatch) {
              firstNameInput.setCustomValidity("Please enter a valid first name");
            } else {
              firstNameInput.setCustomValidity("");
            }
            document.getElementById("firstNameError").innerHTML = firstNameInput.validationMessage;
          });

          var emailInput = document.getElementById("email");
          emailInput.addEventListener("input", function() {
            if (emailInput.validity.typeMismatch) {
              emailInput.setCustomValidity("Please enter a valid email address");
            } else {
              emailInput.setCustomValidity("");
            }
            document.getElementById("emailError").innerHTML = emailInput.validationMessage;
          });

          var dobInput = document.getElementById("dob");
          dobInput.addEventListener("input", function() {
            var today = new Date();
            var dob = new Date(dobInput.value);
            var age = today.getFullYear() - dob.getFullYear();
            if (dob > today || age < 18) {
              dobInput.setCustomValidity("Please enter a valid date of birth");
            } else {
              dobInput.setCustomValidity("");
            }
            document.getElementById("dobError").innerHTML = dobInput.validationMessage;
          });

          var phoneInput = document.getElementById("phone_number");
          phoneInput.addEventListener("input", function() {
            if (phoneInput.validity.patternMismatch) {
              phoneInput.setCustomValidity("Please enter a valid phone number");
            } else {
              phoneInput.setCustomValidity("");
            }
            document.getElementById("phoneError").innerHTML = phoneInput.validationMessage;
          });
    </script>
{% endblock %}

